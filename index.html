<!DOCTYPE html>
<html>

<head>
  <title>FFNN Regression</title>
  <link href="./style.css" rel="stylesheet" <!-- Import Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
  <!-- Import Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <!-- Import TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
  <!-- Import tfjs-vis -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.0.2/dist/tfjs-vis.umd.min.js"></script>
</head>

<body>
  <!-- Import the main  onchange="handleChange()"script file -->
  <h1 class="fs-2 ms-1 mt-2">Regression using a Feed Forward Neural Network</h1>

  <div id="numberOfSamples" class="section">
    <span class="d-flex">
      <h5>Samples</h5>
      <button type="button" class="btn btn-outline-primary btn-sm ms-auto" data-bs-toggle="tooltip"
        data-bs-placement="top" title="Click number of samples to visualize and select data for training and testing">
        ?
      </button>
    </span>
    <label for="exampleFormControlInput1" class="form-label">Number of samples</label>
    <div id="numberSamplesRadio">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="numberSamplesRadio5" value="0"
          onchange="handleSamplesRadioChange()">
        <label class="form-check-label" for="numberSamplesRadio5">5</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="numberSamplesRadio10" value="1"
          onchange="handleSamplesRadioChange()">
        <label class="form-check-label" for="numberSamplesRadio10">10</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="numberSamplesRadio20" value="2"
          onchange="handleSamplesRadioChange()">
        <label class="form-check-label" for="numberSamplesRadio20">20</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="numberSamplesRadio50" value="3"
          onchange="handleSamplesRadioChange()">
        <label class="form-check-label" for="numberSamplesRadio50">50</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="numberSamplesRadio100" value="4"
          onchange="handleSamplesRadioChange()">
        <label class="form-check-label" for="numberSamplesRadio100">100</label>
      </div>
    </div>
  </div>

  <div class="section">
    <span class="d-flex">
      <h5>Model</h5>
      <button type="button" class="btn btn-outline-primary btn-sm ms-auto" data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Set model parameters based on available presets by clicking on preset or set individual parameters. To create model and visualize model parameters click 'Create Model'">
        ?
      </button>
    </span>
    <div class="mb-3">
      <div>
        <a class="link-primary" onclick="handlePresetsUnderFitting()">Underfitting</a>
        <a class="link-primary ms-1" onclick="handlePresetsOverFitting()">Overfitting</a>
        <a class="link-primary ms-1" onclick="handlePresetsBestFit()">Best Fit</a>
      </div>
    </div>
    <div class="mb-3">
      <label for="hiddenLayers" class="form-label">Hidden layers</label>
      <input type="number" class="form-control" id="hiddenLayers" onchange="handleHiddenLayersChange()">
    </div>
    <div class="mb-3">
      <label for="neuronsPerLayer" class="form-label">Neurons per layer</label>
      <input type="number" class="form-control" id="neuronsPerLayer" onchange="handleNeuronsChange()">
    </div>
    <div class="mb-3">
      <label for="activationFunction" class="form-label">Activation function</label>
      <select id="activationFunction" class="form-select" onchange="handleActivationFunctionChange()">
        <option selected disabled>Choose activation function</option>
        <option value="relu">Relu</option>
        <option value="softmax">Softmax</option>
      </select>
    </div>
    <div class="mb-3">
      <button class="btn btn-primary" onclick="create()">Create Model</button>
    </div>
  </div>

  <div class="section">
    <span class="d-flex">
      <h5>Train & Test</h5>
      <button type="button" class="btn btn-outline-primary btn-sm ms-auto" data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Keep number of epochs from model preset or set individual number of epochs. To start training click 'Train Model'. To test model click 'Test Model'. For testing different samples, switch number of samples">
        ?
      </button>
    </span>
    <div class="mb-3">
      <label for="epochs" class="form-label">Epochs</label>
      <input type="number" class="form-control" id="epochs" onchange="handleEpochsChange()">
    </div>
    <button class="btn btn-primary" onclick="train()">Train Model</button>

    <button class="btn btn-primary" onclick="test()">Test Model</button>
  </div>

  <div class="section">
    <h5>Experiments & Results</h5>
    <p>Using softmax activation function it was not possible
      to move mse beneath 0.4 independently of sample or model parameters.
      Hence in all further experiments Relu is used as activation function.
    </p>

    <table class="table">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Samples</th>
          <th scope="col">Layers</th>
          <th scope="col">Neurons</th>
          <th scope="col">Activation</th>
          <th scope="col">Epochs</th>
          <th scope="col">Results</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row">1</th>
          <td>5</td>
          <td>2</td>
          <td>6</td>
          <td>Relu</td>
          <td>100</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>5</td>
          <td>6</td>
          <td>12</td>
          <td>Relu</td>
          <td>150</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">3</th>
          <td>5</td>
          <td>12</td>
          <td>32</td>
          <td>Relu</td>
          <td>200</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">1</th>
          <td>10</td>
          <td>2</td>
          <td>6</td>
          <td>Relu</td>
          <td>100</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>10</td>
          <td>6</td>
          <td>12</td>
          <td>Relu</td>
          <td>150</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">3</th>
          <td>10</td>
          <td>12</td>
          <td>32</td>
          <td>Relu</td>
          <td>200</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">1</th>
          <td>20</td>
          <td>2</td>
          <td>6</td>
          <td>Relu</td>
          <td>100</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>20</td>
          <td>6</td>
          <td>12</td>
          <td>Relu</td>
          <td>150</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">3</th>
          <td>20</td>
          <td>12</td>
          <td>32</td>
          <td>Relu</td>
          <td>200</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">1</th>
          <td>50</td>
          <td>2</td>
          <td>6</td>
          <td>Relu</td>
          <td>100</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>50</td>
          <td>6</td>
          <td>12</td>
          <td>Relu</td>
          <td>150</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">3</th>
          <td>50</td>
          <td>12</td>
          <td>32</td>
          <td>Relu</td>
          <td>200</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">1</th>
          <td>100</td>
          <td>2</td>
          <td>6</td>
          <td>Relu</td>
          <td>100</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>100</td>
          <td>6</td>
          <td>12</td>
          <td>Relu</td>
          <td>150</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
        <tr>
          <th scope="row">3</th>
          <td>100</td>
          <td>12</td>
          <td>32</td>
          <td>Relu</td>
          <td>200</td>
          <td>
            <img class="result-img" src="./img/test.png" alt="">
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <script src="script.js"></script>

</html>